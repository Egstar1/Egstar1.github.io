<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>App 检测 | Egstar站长</title><meta name="author" content="Egstar"><meta name="copyright" content="Egstar"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="app检测除了一些常见的web漏洞，还可以从一些其他思路对app进行检查。本文就将对app的检测进行讨论">
<meta property="og:type" content="article">
<meta property="og:title" content="App 检测">
<meta property="og:url" content="http://egstar.top/post/55c86894.html">
<meta property="og:site_name" content="Egstar站长">
<meta property="og:description" content="app检测除了一些常见的web漏洞，还可以从一些其他思路对app进行检查。本文就将对app的检测进行讨论">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://egstar.top/images/hdj.png">
<meta property="article:published_time" content="2024-06-23T10:27:08.000Z">
<meta property="article:modified_time" content="2024-12-04T01:37:33.344Z">
<meta property="article:author" content="Egstar">
<meta property="article:tag" content="app">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://egstar.top/images/hdj.png"><link rel="shortcut icon" href="/images/favicon.png"><link rel="canonical" href="http://egstar.top/post/55c86894.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Egstar","link":"链接: ","source":"来源: Egstar站长","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'App 检测',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-12-04 09:37:33'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/modify.css"><link rel="stylesheet" href="/css/page.css"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/custom.css"><meta name="generator" content="Hexo 7.2.0"></head><body><link rel="stylesheet" href="/css/loading-bar.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/images/pkds.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">37</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">26</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-solid fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/catlog/"><i class="fa-fw fa-solid fa-pen-to-square"></i><span> 更新日志</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 文娱</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page child" href="/classics/"><i class="fa-fw fa-solid fa-book-open-reader"></i><span> 古典</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-solid fa-comments"></i><span> 关于</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></li><li><a class="site-page child" href="/comments/"><i class="fa-fw fa-solid fa-message"></i><span> 留言板</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/images/hdj.png')"><nav id="nav"><span id="blog-info"><a href="/" title="Egstar站长"><span class="site-name">Egstar站长</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-solid fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/catlog/"><i class="fa-fw fa-solid fa-pen-to-square"></i><span> 更新日志</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 文娱</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page child" href="/classics/"><i class="fa-fw fa-solid fa-book-open-reader"></i><span> 古典</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-solid fa-comments"></i><span> 关于</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></li><li><a class="site-page child" href="/comments/"><i class="fa-fw fa-solid fa-message"></i><span> 留言板</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">App 检测</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-06-23T10:27:08.000Z" title="发表于 2024-06-23 18:27:08">2024-06-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-12-04T01:37:33.344Z" title="更新于 2024-12-04 09:37:33">2024-12-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/">渗透测试</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">4.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>14分钟</span></span><span class="post-meta-separator">|</span><span id="" data-flag-title="App 检测"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><body>

<blockquote>
<p>本文来自于<strong>Z0安全公众号</strong>文章《APP渗透测试方案》，链接地址：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/DsrrqZPIdJmeDR8e6S1Jpw">https://mp.weixin.qq.com/s/DsrrqZPIdJmeDR8e6S1Jpw</a></p>
</blockquote>
<h1 id="1-移动安全测试点分析"><a href="#1-移动安全测试点分析" class="headerlink" title="1.移动安全测试点分析"></a><strong>1.移动安全测试点分析</strong></h1><h2 id="1-1主要测试"><a href="#1-1主要测试" class="headerlink" title="1.1主要测试"></a>1.1主要测试</h2><table>
<thead>
<tr>
<th>客户端</th>
<th>数据传输</th>
<th>服务端</th>
</tr>
</thead>
<tbody><tr>
<td>反编译<br/>二次打包<br/>组件安全<br/>Webview漏洞<br/>数据安全<br/>界面劫持<br/>数据备份风险<br/>Debug调试风险<br/>安全策略</td>
<td>数据窃听<br/>中间人攻击<br/>信息泄露<br/>任意修改数据包</td>
<td>SQL注入<br/>上传漏洞<br/>暴力破解<br/>逻辑漏洞<br/>XSS<br/>任意文件读取<br/>越权漏洞</td>
</tr>
</tbody></table>
<h2 id="1-2Android测试思维导图"><a href="#1-2Android测试思维导图" class="headerlink" title="1.2Android测试思维导图"></a>1.2Android测试思维导图</h2><p><img src="https://mmbiz.qpic.cn/mmbiz_png/3ClhvEA8OWoXxOYfelPgZyAAVDaQ5kjNibo2ufibGSZzubOULqJYUsxw5tTRicmETs01fFicqtwUJ3CR5OicbiamkBhw/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<h3 id="1-客户端反编译"><a href="#1-客户端反编译" class="headerlink" title="1.客户端反编译"></a>1.客户端反编译</h3><p>主要工具：Android killer、apktool、jd-gui、JADX、IDA pro等  </p>
<p>反编译测试方法：  </p>
<p>①.毫无加固的APK</p>
<p>直接用Android killer 或Apk tool 进行反编译，会反编译成功，并能看到Smail代码，通过代码逻辑来分析存在的漏洞。反编译后可对APK关键点代码审计安全问题，如登录、注册、付费、敏感信息等。如图1-1，对xx音乐APK用android killer反编译结果。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/3ClhvEA8OWoXxOYfelPgZyAAVDaQ5kjNJtiarCmIeMy3R6H5QCCYTtkZiaOhpUV45MjFIlAayAico8Wia4hkPbbzmw/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>②.代码混淆</p>
<p>代码混淆后进行反编译，方法名称并不是原名称，代码逻辑混乱，不易阅读，反编译后无实际意义。</p>
<p>③.APK加壳</p>
<p>若客户端进行加壳保护，此时认为无风险。若大部分代码（包括核心代码）经过混淆，此时低风险。   </p>
<h3 id="2-二次打包"><a href="#2-二次打包" class="headerlink" title="2.二次打包"></a>2.二次打包</h3><p>二次打包流程：  </p>
<p>对APK文件做反编译分析，反编译为smali代码，并对某些关键函数或者资源进行修改，再回编译为apk文件并重签名。</p>
<p>防止二次打包测试点：  </p>
<p>①自校验：校验修改前后的不同：</p>
<p>（1）文件大小</p>
<p>（2）APK文件的MD5（Hash值）</p>
<p>（3）Dex、xml、res、arsc文件不同，png&#x2F;mp3&#x2F;jpg等相同</p>
<p>所有具有反编译过程的文件重新打包后，Hash都是变化的:</p>
<p>Android killer 对apk反编译时，反编译的文件有（res&#x2F;xml&#x2F;classes.dex&#x2F;）</p>
<p>png&#x2F;mp3&#x2F;jpg 等资源文件是不参与反编译和编译，如图1-2是编译失败过程</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/3ClhvEA8OWoXxOYfelPgZyAAVDaQ5kjNLOtB7EyduiahbTbB536gVRwmFtlzN0E9BXvRwjTUHGcgUBMkhlviaEqQ/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>②签名校验：</p>
<p>签名文件：META-INF，二次打包后签名文件一定会变。</p>
<p>APK 必须进行签名后，方可安装和运行。如果开启了“允许未知来源的应 用”，那么 Debug 证书、自签名证书、过期证书的签名都是可以的，但是不可以不签名。</p>
<p>遇到签名校验的地方，搜索的关键词：</p>
<p>签名绕过：某些apk为了防止重打包，使用了签名校验。所以在绕过的时候的时候我们需要破解签名校验。在定位签名校验位置时常用的关键词有sign，signature，checkSign，signCheck，getPackageManager，getPackageInfo，verify，same等。</p>
<p>区分校验方式：区分APK是签名校验还是文件校验的方式,删除Apk META-INF 重签名校验。   </p>
<h3 id="3-组件安全"><a href="#3-组件安全" class="headerlink" title="3.组件安全"></a>3.组件安全</h3><p><strong>Android四大组件：</strong>  </p>
<p>安卓系统的组件共有四种，其主要用途分别为：</p>
<p>Activity：呈现可供用户交互的界面，是最常见的组件；甚至可以理解为一个“界面”就是一个 Activity。</p>
<p>Service：长时间执行后台作业，常见于监控类应用；</p>
<p>Content Provider：在多个 APP 间共享数据，比如通讯录数据；</p>
<p>Broadcast Receiver：注册特定事件，并在其发生时被激活；</p>
<p><strong>组件导出的危害</strong>  </p>
<p>有些 APP 的功能需要提供一些接口给其它 APP 访问，就需要把相关的接口功能放在一个导出的组件上。因为权限声明是以组件为单位的，A 组件调用 B 组件的功能来访问操作系统 API 时，适 用于B 组件的权限声明。如果 B 作为导出组件，没有进行严格的访问控制，那么 A 就可以通过调用 B 来访问原本 没有声明权限的功能，构成本地权限提升。</p>
<p><strong>主要测试点：组件的导出（高危）</strong>  </p>
<p>1.1AndroidManifest.xml，对其中声明的各个组件， 根据以下规则判断是否可导出：</p>
<p>\1. 显式声明了 android:exported&#x3D;”true”，则可导出；</p>
<p>\2. 显示声明了 android:exported&#x3D;”false”，则不可导出；   </p>
<p>\3. 未显示声明 android:exported：</p>
<p>a) 若组件不是 Content Provider：i. 若组件包含则可导出，反之不可；</p>
<p>b) 若组件是 Content Provider：i. 若 SDK 版本&lt;17,可以导出；</p>
<p>从测试的角度上，只能判断组件是否导出，但能否构成危害需要详细分析源代码后才能得出结论。一般来说，在测试时尽管写清所有的导出组件，由客户开发侧确认相关组件是否确实需要导出即可。如图2-1，AndroidManifest.xml部分截图。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/3ClhvEA8OWoXxOYfelPgZyAAVDaQ5kjNQ62phMFREcd38q76zM5ruteWIZnG5rkvuSw6wzXt2XUYkm1PTseVFQ/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/3ClhvEA8OWoXxOYfelPgZyAAVDaQ5kjN85fLNb1ogsQickC6JSatWnmnA47W6ada9piblSMtCB3Txic0qHFnJotJw/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>1.2.执行 adb shell 获得一个 shell，使用 am start –n com.isi.testapp&#x2F;.Welcome 来启动 Activity ，查看是否在未经登录的情况下，该 activity 被正常显示，且形成越权、信息泄露等风险</p>
<h3 id="4-Webview漏洞"><a href="#4-Webview漏洞" class="headerlink" title="4.Webview漏洞"></a>4.Webview漏洞</h3><p>Android 4.2 版本以下的 webview 组件存在安全漏洞（CVE-2012-6636）。检测客户端 是否采取措施避免漏洞被利用。检查应用 AndroidManifest.xml 中的 targetSdkVersion 是否大于等于 17。</p>
<h3 id="5-数据安全-中危"><a href="#5-数据安全-中危" class="headerlink" title="5.数据安全(中危)"></a>5.数据安全(中危)</h3><p>APP评估中可在该文件夹中AndroidManifest.xml文件中检查的两项：</p>
<p>allowbackup备份权限，ture则存在备份数据泄露风险（未配置的情况下，默认为TRUE）</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/3ClhvEA8OWoXxOYfelPgZyAAVDaQ5kjNsRx19oH9PCWib1qOdDqqRUfLP3icLfmv4mfQJIg0NlXMNcKaVLIQU6Yw/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/3ClhvEA8OWoXxOYfelPgZyAAVDaQ5kjNTiajV1xkz7EHzJHbJjQyp90eUSTXTtmq8QJ3W2jnha47icXbhcUF89iaA/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<h3 id="6-界面劫持"><a href="#6-界面劫持" class="headerlink" title="6.界面劫持"></a>6.界面劫持</h3><p>  界面劫持是指在Android系统中，恶意软件通过监控目标软件的运行，当检测到当前运行界面为某个被监控应用的特定界面时（一般为登录或支付界面），弹出伪造的钓鱼页面，从而诱导用户输入信息，最终窃取用户的隐私（恶意盗取用户账号、卡号、密码等信息），或者利用假冒界面进行钓鱼欺诈。</p>
<h3 id="7-Debug调试风险"><a href="#7-Debug调试风险" class="headerlink" title="7.Debug调试风险"></a>7.Debug调试风险</h3><p>AndroidManifest.xml 中的 android:debuggable&#x3D;”true”标记如果开启，可被 Java 调试工具例如 jdb 进行调试，获取和篡改用户敏感信息，甚至分析并且修改代码实现 L-songxuliang 的业务逻辑，我们经常使用 android.util.Log 来打印日志，软件发布后调试日志被其他开发 者看到，容易被反编译破解。检查 AndroidManifest.xml 文件中的 debuggable 属性应为false。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/3ClhvEA8OWoXxOYfelPgZyAAVDaQ5kjNhKv4iaaiatFRquT7tSUNwiaZ8j2p5SDkMhUbZRtfhEtjXJrdlSaOw7bgw/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<h3 id="8-安全策略测试"><a href="#8-安全策略测试" class="headerlink" title="8.安全策略测试"></a>8.安全策略测试</h3><p><strong>密码复杂度策略</strong>  </p>
<p>问题描述 ：如果系统缺少密码复杂度策略，攻击者将有机会通过暴力猜测、撞库等方式获取一些安全意识淡薄的合法用户的认证凭据。   </p>
<p> 测试步骤 ：人工测试，尝试将密码修改为弱口令，如：123456，654321，121212，888888 等，查看客户端是否拒绝弱口令。</p>
<p><strong>认证失败锁定策略</strong>  </p>
<p> 问题描述：如果系统不存在认证失败锁定策略，攻击者将有机会对认证凭据进行暴力猜测。测试步骤：测试客户端是否会限制密码输入错误次数，是否会进行锁定。</p>
<p>安全建议 以 IP 地址或用户账号为单位，如果用户连续进行若干次错误的认证尝试，则禁止其后续认证操作。</p>
<p><strong>单点登录限制策略</strong>  </p>
<p>问题描述：如果系统允许同一个用户同时在多个会话中登录，那么用户就很难察觉到自身的账号已经被盗。</p>
<p>测试步骤：测试同一个帐号是否可以同时在多个设备上登录客户端，进行操作。</p>
<p><strong>会话超时策略</strong>  </p>
<p> 问题描述：对于认证会话不会超时的 APP，如果用户在使用过程中将设备放置一旁并遗忘，攻击者将有可能通过物理接触的方式以用户身份进行操作。</p>
<p>测试步骤 测试客户端在一定时间内无操作后，是否能提示超时并要求重新登录。</p>
<p>安全建议：长时间不操作时，应当终止会话。   </p>
<p><strong>UI敏感信息安全</strong>  </p>
<p>问题描述：视具体的泄露信息而定，敏感信息泄露可能会方便恶意程序窃取凭据，或者泄露一些原 本不希望被用户看到的内容。</p>
<p> 测试步骤：人工观察客户端的各个功能界面，未发现存在敏感信息泄露的问题。在登录界面输入错误的用户名会显示“连接失败”，密码错误时会显示“密码错误”：因此存在风险枚举存在用户名的风险。</p>
<p>安全建议在密码错误和用户名错误的情况应返回相同的信息，例如“用户名或密码错误” 。</p>
<h1 id="2-移动端漏扫工具—MobSF"><a href="#2-移动端漏扫工具—MobSF" class="headerlink" title="2.移动端漏扫工具—MobSF"></a><strong>2.移动端漏扫工具—MobSF</strong></h1><h2 id="0x01-MobSF介绍"><a href="#0x01-MobSF介绍" class="headerlink" title="0x01 MobSF介绍"></a>0x01 MobSF介绍</h2><p> 移动安全框架（MobSF）是一种自动、一体化的移动应用（Android &#x2F; iOS &#x2F; Windows）静态和动态分析的测试，恶意软件分析和安全评估框架。</p>
<p> MobSF框架还可以通过其API Fuzzer功能模块，对Web API的安全性进行检测，包括收集信息、分析安全头部信息、识别移动API的具体漏洞等</p>
<h2 id="0x02-安装"><a href="#0x02-安装" class="headerlink" title="0x02 安装"></a>0x02 安装</h2><h3 id="安装要求"><a href="#安装要求" class="headerlink" title="安装要求"></a>安装要求</h3><p>1.Python 3.8-3.9</p>
<p>2.Jdk 8+</p>
<p>3.安装Microsoft Visual C++ 构建工具</p>
<p>4.安装OpenSSL 1.1.1</p>
<p>5.安装Git 2.32.02</p>
<p>6.wkhtmltopdf（并且配置环境变量）</p>
<p>以上环境必须满足，版本注意保持一致或者最新，否则后面安装过程会报错   </p>
<p>官方文档有对应环境的最新下载链接  </p>
<h3 id="安装过程"><a href="#安装过程" class="headerlink" title="安装过程"></a>安装过程</h3><h6 id="1-前期环境准备好之后，开始安装Mobsf，从GitHub克隆，公司内网不能访问github-建议使用其他网络，也可以用码云上的资源克隆，注意选择版本要最新版"><a href="#1-前期环境准备好之后，开始安装Mobsf，从GitHub克隆，公司内网不能访问github-建议使用其他网络，也可以用码云上的资源克隆，注意选择版本要最新版" class="headerlink" title="1.前期环境准备好之后，开始安装Mobsf，从GitHub克隆，公司内网不能访问github,建议使用其他网络，也可以用码云上的资源克隆，注意选择版本要最新版"></a>1.前期环境准备好之后，开始安装Mobsf，从GitHub克隆，公司内网不能访问github,建议使用其他网络，也可以用码云上的资源克隆，注意选择版本要最新版</h6><pre class="line-numbers language-none"><code class="language-none">git clone https:&#x2F;&#x2F;github.com&#x2F;MobSF&#x2F;Mobile-Security-Framework-MobSF.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h6 id="2-克隆完成过程"><a href="#2-克隆完成过程" class="headerlink" title="2.克隆完成过程"></a>2.克隆完成过程</h6><pre class="line-numbers language-none"><code class="language-none">正克隆到 &#39;Mobile-Security-Framework-MobSF&#39;...
remote: Enumerating objects: 16268, done.
remote: Counting objects: 100% (16268&#x2F;16268), done.
remote: Compressing objects: 100% (8216&#x2F;8216), done.
接收对象中:  34% (5691&#x2F;16268), 540.95 MiB | 214.00 KiB&#x2F;s
remote: Total 16268 (delta 7623), reused 16268 (delta 7623), pack-reused 0
接收对象中: 100% (16268&#x2F;16268), 940.24 MiB | 219.00 KiB&#x2F;s, 完成.
处理 delta 中: 100% (7623&#x2F;7623), 完成.
正在更新文件: 100% (377&#x2F;377), 完成.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="3-安装过程，setup-bat会运行较长时间，安装依赖较多，如遇报错，可根据实际情况来解决"><a href="#3-安装过程，setup-bat会运行较长时间，安装依赖较多，如遇报错，可根据实际情况来解决" class="headerlink" title="3.安装过程，setup.bat会运行较长时间，安装依赖较多，如遇报错，可根据实际情况来解决"></a>3.安装过程，setup.bat会运行较长时间，安装依赖较多，如遇报错，可根据实际情况来解决</h6><pre class="line-numbers language-none"><code class="language-none">cd Mobile-Security-Framework-MobSF
setup.bat<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h6 id="4-安装成功后会有提示，然后浏览器打开localhost-8000-默认监听8000端口-来测试，如果需要修改默认端口，可以在run-bat中进行修改SETconf-”0-0-0-0-8000”中的端口号"><a href="#4-安装成功后会有提示，然后浏览器打开localhost-8000-默认监听8000端口-来测试，如果需要修改默认端口，可以在run-bat中进行修改SETconf-”0-0-0-0-8000”中的端口号" class="headerlink" title="4.安装成功后会有提示，然后浏览器打开localhost:8000(默认监听8000端口)来测试，如果需要修改默认端口，可以在run.bat中进行修改SETconf&#x3D;”0.0.0.0:8000”中的端口号"></a>4.安装成功后会有提示，然后浏览器打开localhost:8000(默认监听8000端口)来测试，如果需要修改默认端口，可以在run.bat中进行修改SETconf&#x3D;”0.0.0.0:8000”中的端口号</h6><pre class="line-numbers language-none"><code class="language-none">cd Mobile-Security-Framework-MobSF
run.bat<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h6 id="5-在安完成启动时遇见以下报错，经过分析由于网络问题导致无法访问一些域名如raw-githubusercontent-com这个域名，从而运行界面会出现报错提示，这里通过IPaddress查询到真实IP，修改本地host文件来访问。如网络正常访问没遇见报错，这步可省略"><a href="#5-在安完成启动时遇见以下报错，经过分析由于网络问题导致无法访问一些域名如raw-githubusercontent-com这个域名，从而运行界面会出现报错提示，这里通过IPaddress查询到真实IP，修改本地host文件来访问。如网络正常访问没遇见报错，这步可省略" class="headerlink" title="5.在安完成启动时遇见以下报错，经过分析由于网络问题导致无法访问一些域名如raw.githubusercontent.com这个域名，从而运行界面会出现报错提示，这里通过IPaddress查询到真实IP，修改本地host文件来访问。如网络正常访问没遇见报错，这步可省略"></a>5.在安完成启动时遇见以下报错，经过分析由于网络问题导致无法访问一些域名如raw.githubusercontent.com这个域名，从而运行界面会出现报错提示，这里通过IPaddress查询到真实IP，修改本地host文件来访问。如网络正常访问没遇见报错，这步可省略</h6><pre class="line-numbers language-none"><code class="language-none">Traceback (most recent call last):
  File &quot;C:\Mobile-Security-Framework-MobSF\mobsf\MobSF\utils.py&quot;, line 114, in check_update
    response &#x3D; requests.get(github_url, timeout&#x3D;5,
  File &quot;c:\mobile-security-framework-mobsf\venv\lib\site-packages\requests\api.py&quot;, line 76, in get
    return request(&#39;get&#39;, url, params&#x3D;params, **kwargs)
  File &quot;c:\mobile-security-framework-mobsf\venv\lib\site-packages\requests\api.py&quot;, line 61, in request
    return session.request(method&#x3D;method, url&#x3D;url, **kwargs)
  File &quot;c:\mobile-security-framework-mobsf\venv\lib\site-packages\requests\sessions.py&quot;, line 542, in request
    resp &#x3D; self.send(prep, **send_kwargs)
  File &quot;c:\mobile-security-framework-mobsf\venv\lib\site-packages\requests\sessions.py&quot;, line 655, in send
    r &#x3D; adapter.send(request, **kwargs)
  File &quot;c:\mobile-security-framework-mobsf\venv\lib\site-packages\requests\adapters.py&quot;, line 516, in send
    raise ConnectionError(e, request&#x3D;request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host&#x3D;&#39;raw.githubusercontent.com&#39;, port&#x3D;443): Max retries exceeded with url: &#x2F;MobSF&#x2F;Mobile-Security-Framework-MobSF&#x2F;master&#x2F;mobsf&#x2F;MobSF&#x2F;init.py (Caused by NewConnectionError(&#39;&lt;urllib3.connection.HTTPSConnection object at 0x000001CC9E49AFD0&gt;: Failed to establish a new connection: [Errno 11004] getaddrinfo failed&#39;))        <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="0x03-静态分析"><a href="#0x03-静态分析" class="headerlink" title="0x03 静态分析"></a>0x03 静态分析</h2><p>静态分析仅需上传响应的APK&#x2F;ios包即可，上传后需耐心等待</p>
<h3 id="Android扫描内容"><a href="#Android扫描内容" class="headerlink" title="Android扫描内容"></a><strong>Android扫描内容</strong></h3><p>APK基本信息：文件名、文件大小、MD5、SHA-1、SHA-256</p>
<p>APP信息：包名、Main Activity、版本号等</p>
<p>组件：Activity、Service、Broadcast Receiver、Content Provider</p>
<p>证书信息(Signer Certificate)</p>
<p>权限信息</p>
<p>Android API信息</p>
<p>Androidmanifest分析(标志位、组件配置等)</p>
<p>代码分析、文件分析</p>
<p>url、email、string等</p>
<h3 id="报告查看"><a href="#报告查看" class="headerlink" title="报告查看"></a><strong>报告查看</strong></h3><p>结果分析报告</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/3ClhvEA8OWoXxOYfelPgZyAAVDaQ5kjNhX2mPXYnIYouwkUk6GTfCicdTXvj7A35LcXiaE0cLCg1W3apWqZKtskA/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<h5 id="MobSF源码分析——静态分析原理"><a href="#MobSF源码分析——静态分析原理" class="headerlink" title="MobSF源码分析——静态分析原理"></a>MobSF源码分析——静态分析原理</h5><h2 id="0x04-动态分析"><a href="#0x04-动态分析" class="headerlink" title="0x04 动态分析"></a>0x04 动态分析</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a><strong>简介</strong></h3><p>动态分析MobSF支持Android（iOS 应用不支持),可以动态调试正在运行的应用。</p>
<p>如果需要动态分析，请不要在Docker或虚拟机中部署MobSF，另外需要下载安装Genymotion模拟器。</p>
<h3 id="设备系统版本"><a href="#设备系统版本" class="headerlink" title="设备系统版本"></a><strong>设备系统版本</strong></h3><p>设备系统版本 在启动MobSF之前，请运行Genymotion模拟器 。一切都会在运行时自动配置。建议使用Android 7.0及更高版本。   </p>
<p>Android 5.0-9.0-这些版本使用Frida（一款基于python + java 的hook框架),开箱即用。</p>
<p>Android 4.1-4.4- 这些版本使用Xposed Framework。</p>
<h3 id="HTTPS代理"><a href="#HTTPS代理" class="headerlink" title="HTTPS代理"></a>HTTPS代理</h3><p>对于Android的版本4.4 - 9.0，全局代理设置在运行时自动应用。</p>
<p>对于Android版本4.1-4.3，需要设置Dynamic Analyzer页面中显示的Android VM代理。</p>
<h3 id="安装Genymotion"><a href="#安装Genymotion" class="headerlink" title="安装Genymotion"></a>安装Genymotion</h3><h6 id="1-安装界面"><a href="#1-安装界面" class="headerlink" title="1.安装界面"></a>1.安装界面</h6><h6 id="2-选择一个Android设备名称"><a href="#2-选择一个Android设备名称" class="headerlink" title="2.选择一个Android设备名称"></a>2.选择一个Android设备名称</h6><h6 id="3-不能为虚拟电脑打开新任务的问题，网络问题，通过启动网卡解决"><a href="#3-不能为虚拟电脑打开新任务的问题，网络问题，通过启动网卡解决" class="headerlink" title="3.不能为虚拟电脑打开新任务的问题，网络问题，通过启动网卡解决"></a>3.不能为虚拟电脑打开新任务的问题，网络问题，通过启动网卡解决</h6><h6 id="4-启动后，一直卡在starting-virtual-device，把Oracle-VM-VirtualBox-删除，重新安装了一次发现问题解决了，Android顺利运行了"><a href="#4-启动后，一直卡在starting-virtual-device，把Oracle-VM-VirtualBox-删除，重新安装了一次发现问题解决了，Android顺利运行了" class="headerlink" title="4.启动后，一直卡在starting virtual device，把Oracle VM VirtualBox 删除，重新安装了一次发现问题解决了，Android顺利运行了"></a>4.启动后，一直卡在starting virtual device，把Oracle VM VirtualBox 删除，重新安装了一次发现问题解决了，Android顺利运行了</h6><h3 id="ARM转换"><a href="#ARM转换" class="headerlink" title="ARM转换"></a><strong>ARM转换</strong></h3><p>Genymotion是基于X86的，不支持ARM架构。所以有些应用(这里我测试了云上协同、抖音APK均是ARM架构)是基于ARM架构编译的就无法安装，出现如下提示：</p>
<p>An error occured while deploying the file. This probably means that the app contains ARM native code and your Genymotion device cannot run ARM instructions. You should either build your native code to x86 or install an ARM translation tool in your device.</p>
<p>下载安装转换工具Genymotion_ARM_Translation 根据自己的模拟器系统版本下载对应的zip包，然后将包直接拖入到模拟器安装，安装完成后重启模拟器即可。这里我使用的android 8的版本</p>
<p>因为较多应用是基于ARM架构的，所以这一步必须要安装，在Genymotion目录下找到adb.exe文件，复制路径在cmd中打开 </p>
<p>然后执行这个命令，成功之后就可以使用Genymotion了</p>
<pre class="line-numbers language-none"><code class="language-none">adb shell flash-archive.sh &#x2F;sdcard&#x2F;Download&#x2F;Genymotion-ARM-Translation_v1.1.zip     <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="动态分析实验"><a href="#动态分析实验" class="headerlink" title="动态分析实验"></a>动态分析实验</h3><h6 id="1-开启mobsf和Genymotion的Android之后，mobsf会自动识别链接，IP地址与安卓的地址是一致的。"><a href="#1-开启mobsf和Genymotion的Android之后，mobsf会自动识别链接，IP地址与安卓的地址是一致的。" class="headerlink" title="1.开启mobsf和Genymotion的Android之后，mobsf会自动识别链接，IP地址与安卓的地址是一致的。"></a>1.开启mobsf和Genymotion的Android之后，mobsf会自动识别链接，IP地址与安卓的地址是一致的。</h6><h6 id="2-测试动态分析环境是否正常，点击MobSFy-Android-Runtime-然后点击弹窗界面的MobSFy"><a href="#2-测试动态分析环境是否正常，点击MobSFy-Android-Runtime-然后点击弹窗界面的MobSFy" class="headerlink" title="2.测试动态分析环境是否正常，点击MobSFy Android Runtime,然后点击弹窗界面的MobSFy!"></a>2.测试动态分析环境是否正常，点击MobSFy Android Runtime,然后点击弹窗界面的MobSFy!</h6><h6 id="3-测试正常之后就可以动态分析了"><a href="#3-测试正常之后就可以动态分析了" class="headerlink" title="3.测试正常之后就可以动态分析了"></a>3.测试正常之后就可以动态分析了</h6><h6 id="Show-Stop-Screen"><a href="#Show-Stop-Screen" class="headerlink" title="Show&#x2F;Stop Screen"></a>Show&#x2F;Stop Screen</h6><p>1.点击Show Screen 可以实时同步设备屏幕，方便测试执行查看。在Dynamic Analyzer菜单可以查看实时动态分析日志，Errors菜单可以查看错误日志。</p>
<p>2.Frida Scripts 栏设置是设置Frida相关选项，Frida是个轻量级别的hook框架，核心是用C编写的，并将Google的V8引擎注入到目标进程中，在这些进程中，JS可以完全访问内存，Hook函数甚至调用进程内的本机函数来执行。</p>
<p>3.一般使用默认的配置选项即可，如果想进阶测试，可以勾选Auxiliary中的选项，甚至右侧Frida Code Editor编辑窗口，可以直接编写脚本进行调试。Fira使用教程请参考官方文档:<a target="_blank" rel="noopener" href="https://frida.re/docs/home/">https://frida.re/docs/home/</a>   </p>
<h6 id="Install-Remove-MobSF-RootCA"><a href="#Install-Remove-MobSF-RootCA" class="headerlink" title="Install&#x2F;Remove MobSF RootCA"></a>Install&#x2F;Remove MobSF RootCA</h6><p>Install&#x2F;Remove MobSF RootCA用来安装卸载MobSF CA证书,方便对样本中HTTPS流量进行截获。</p>
<h6 id="Start-Exported-Activity-Tester"><a href="#Start-Exported-Activity-Tester" class="headerlink" title="Start Exported Activity Tester"></a>Start Exported Activity Tester</h6><p>遍历获取AndroidManifest.xml文件中的所有Exported Activity 测试流程如下：</p>
<p>1.依次启动activity，adb -s IP:PORT shell am start -n PACKAGE&#x2F;ACTIVITY</p>
<p>2.获取当前activity运行时的屏幕截图，并保存截屏</p>
<p>3.强制关闭应用：adb -s IP:PORT shell am force-stop PACKAGE</p>
<h6 id="Start-Activity-Tester"><a href="#Start-Activity-Tester" class="headerlink" title="Start Activity Tester"></a>Start Activity Tester</h6><p>遍历AndroidManifest.xml文件中的所有Activity，而不单单是Exported。</p>
<p>处理流程与Exported Activity一致。</p>
<h6 id="Take-a-Screenshot"><a href="#Take-a-Screenshot" class="headerlink" title="Take a Screenshot"></a>Take a Screenshot</h6><p>截屏并保存到本地。</p>
<h6 id="Generate-Report"><a href="#Generate-Report" class="headerlink" title="Generate Report"></a>Generate Report</h6><p>生成动态分析报告</p>
</body>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://egstar.top">Egstar</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://egstar.top/post/55c86894.html">http://egstar.top/post/55c86894.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://egstar.top" target="_blank">Egstar站长</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/app/">app</a></div><div class="post_share"><div class="social-share" data-image="/images/hdj.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/44adbab3.html" title="Netsh 命令"><img class="cover" src="/images/abd.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Netsh 命令</div></div></a></div><div class="next-post pull-right"><a href="/post/735058fd.html" title="SQL注入 POC"><img class="cover" src="/images/kabd.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">SQL注入 POC</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/images/pkds.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Egstar</div><div class="author-info__description">安全秘辛，古文经典</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">37</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">26</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Egstar1"><i class="fab fa-github"></i><span>我的Github</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Egstar1" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1337995241@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E7%82%B9%E5%88%86%E6%9E%90"><span class="toc-number">1.</span> <span class="toc-text">1.移动安全测试点分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1%E4%B8%BB%E8%A6%81%E6%B5%8B%E8%AF%95"><span class="toc-number">1.1.</span> <span class="toc-text">1.1主要测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2Android%E6%B5%8B%E8%AF%95%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE"><span class="toc-number">1.2.</span> <span class="toc-text">1.2Android测试思维导图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%8F%8D%E7%BC%96%E8%AF%91"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.客户端反编译</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BA%8C%E6%AC%A1%E6%89%93%E5%8C%85"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.二次打包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8"><span class="toc-number">1.2.3.</span> <span class="toc-text">3.组件安全</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Webview%E6%BC%8F%E6%B4%9E"><span class="toc-number">1.2.4.</span> <span class="toc-text">4.Webview漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8-%E4%B8%AD%E5%8D%B1"><span class="toc-number">1.2.5.</span> <span class="toc-text">5.数据安全(中危)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E7%95%8C%E9%9D%A2%E5%8A%AB%E6%8C%81"><span class="toc-number">1.2.6.</span> <span class="toc-text">6.界面劫持</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-Debug%E8%B0%83%E8%AF%95%E9%A3%8E%E9%99%A9"><span class="toc-number">1.2.7.</span> <span class="toc-text">7.Debug调试风险</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E5%AE%89%E5%85%A8%E7%AD%96%E7%95%A5%E6%B5%8B%E8%AF%95"><span class="toc-number">1.2.8.</span> <span class="toc-text">8.安全策略测试</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E7%A7%BB%E5%8A%A8%E7%AB%AF%E6%BC%8F%E6%89%AB%E5%B7%A5%E5%85%B7%E2%80%94MobSF"><span class="toc-number">2.</span> <span class="toc-text">2.移动端漏扫工具—MobSF</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-MobSF%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.1.</span> <span class="toc-text">0x01 MobSF介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-%E5%AE%89%E8%A3%85"><span class="toc-number">2.2.</span> <span class="toc-text">0x02 安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E8%A6%81%E6%B1%82"><span class="toc-number">2.2.1.</span> <span class="toc-text">安装要求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E8%BF%87%E7%A8%8B"><span class="toc-number">2.2.2.</span> <span class="toc-text">安装过程</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-%E5%89%8D%E6%9C%9F%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87%E5%A5%BD%E4%B9%8B%E5%90%8E%EF%BC%8C%E5%BC%80%E5%A7%8B%E5%AE%89%E8%A3%85Mobsf%EF%BC%8C%E4%BB%8EGitHub%E5%85%8B%E9%9A%86%EF%BC%8C%E5%85%AC%E5%8F%B8%E5%86%85%E7%BD%91%E4%B8%8D%E8%83%BD%E8%AE%BF%E9%97%AEgithub-%E5%BB%BA%E8%AE%AE%E4%BD%BF%E7%94%A8%E5%85%B6%E4%BB%96%E7%BD%91%E7%BB%9C%EF%BC%8C%E4%B9%9F%E5%8F%AF%E4%BB%A5%E7%94%A8%E7%A0%81%E4%BA%91%E4%B8%8A%E7%9A%84%E8%B5%84%E6%BA%90%E5%85%8B%E9%9A%86%EF%BC%8C%E6%B3%A8%E6%84%8F%E9%80%89%E6%8B%A9%E7%89%88%E6%9C%AC%E8%A6%81%E6%9C%80%E6%96%B0%E7%89%88"><span class="toc-number">2.2.2.0.0.1.</span> <span class="toc-text">1.前期环境准备好之后，开始安装Mobsf，从GitHub克隆，公司内网不能访问github,建议使用其他网络，也可以用码云上的资源克隆，注意选择版本要最新版</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-%E5%85%8B%E9%9A%86%E5%AE%8C%E6%88%90%E8%BF%87%E7%A8%8B"><span class="toc-number">2.2.2.0.0.2.</span> <span class="toc-text">2.克隆完成过程</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-%E5%AE%89%E8%A3%85%E8%BF%87%E7%A8%8B%EF%BC%8Csetup-bat%E4%BC%9A%E8%BF%90%E8%A1%8C%E8%BE%83%E9%95%BF%E6%97%B6%E9%97%B4%EF%BC%8C%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96%E8%BE%83%E5%A4%9A%EF%BC%8C%E5%A6%82%E9%81%87%E6%8A%A5%E9%94%99%EF%BC%8C%E5%8F%AF%E6%A0%B9%E6%8D%AE%E5%AE%9E%E9%99%85%E6%83%85%E5%86%B5%E6%9D%A5%E8%A7%A3%E5%86%B3"><span class="toc-number">2.2.2.0.0.3.</span> <span class="toc-text">3.安装过程，setup.bat会运行较长时间，安装依赖较多，如遇报错，可根据实际情况来解决</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-%E5%AE%89%E8%A3%85%E6%88%90%E5%8A%9F%E5%90%8E%E4%BC%9A%E6%9C%89%E6%8F%90%E7%A4%BA%EF%BC%8C%E7%84%B6%E5%90%8E%E6%B5%8F%E8%A7%88%E5%99%A8%E6%89%93%E5%BC%80localhost-8000-%E9%BB%98%E8%AE%A4%E7%9B%91%E5%90%AC8000%E7%AB%AF%E5%8F%A3-%E6%9D%A5%E6%B5%8B%E8%AF%95%EF%BC%8C%E5%A6%82%E6%9E%9C%E9%9C%80%E8%A6%81%E4%BF%AE%E6%94%B9%E9%BB%98%E8%AE%A4%E7%AB%AF%E5%8F%A3%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%9C%A8run-bat%E4%B8%AD%E8%BF%9B%E8%A1%8C%E4%BF%AE%E6%94%B9SETconf-%E2%80%9D0-0-0-0-8000%E2%80%9D%E4%B8%AD%E7%9A%84%E7%AB%AF%E5%8F%A3%E5%8F%B7"><span class="toc-number">2.2.2.0.0.4.</span> <span class="toc-text">4.安装成功后会有提示，然后浏览器打开localhost:8000(默认监听8000端口)来测试，如果需要修改默认端口，可以在run.bat中进行修改SETconf&#x3D;”0.0.0.0:8000”中的端口号</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#5-%E5%9C%A8%E5%AE%89%E5%AE%8C%E6%88%90%E5%90%AF%E5%8A%A8%E6%97%B6%E9%81%87%E8%A7%81%E4%BB%A5%E4%B8%8B%E6%8A%A5%E9%94%99%EF%BC%8C%E7%BB%8F%E8%BF%87%E5%88%86%E6%9E%90%E7%94%B1%E4%BA%8E%E7%BD%91%E7%BB%9C%E9%97%AE%E9%A2%98%E5%AF%BC%E8%87%B4%E6%97%A0%E6%B3%95%E8%AE%BF%E9%97%AE%E4%B8%80%E4%BA%9B%E5%9F%9F%E5%90%8D%E5%A6%82raw-githubusercontent-com%E8%BF%99%E4%B8%AA%E5%9F%9F%E5%90%8D%EF%BC%8C%E4%BB%8E%E8%80%8C%E8%BF%90%E8%A1%8C%E7%95%8C%E9%9D%A2%E4%BC%9A%E5%87%BA%E7%8E%B0%E6%8A%A5%E9%94%99%E6%8F%90%E7%A4%BA%EF%BC%8C%E8%BF%99%E9%87%8C%E9%80%9A%E8%BF%87IPaddress%E6%9F%A5%E8%AF%A2%E5%88%B0%E7%9C%9F%E5%AE%9EIP%EF%BC%8C%E4%BF%AE%E6%94%B9%E6%9C%AC%E5%9C%B0host%E6%96%87%E4%BB%B6%E6%9D%A5%E8%AE%BF%E9%97%AE%E3%80%82%E5%A6%82%E7%BD%91%E7%BB%9C%E6%AD%A3%E5%B8%B8%E8%AE%BF%E9%97%AE%E6%B2%A1%E9%81%87%E8%A7%81%E6%8A%A5%E9%94%99%EF%BC%8C%E8%BF%99%E6%AD%A5%E5%8F%AF%E7%9C%81%E7%95%A5"><span class="toc-number">2.2.2.0.0.5.</span> <span class="toc-text">5.在安完成启动时遇见以下报错，经过分析由于网络问题导致无法访问一些域名如raw.githubusercontent.com这个域名，从而运行界面会出现报错提示，这里通过IPaddress查询到真实IP，修改本地host文件来访问。如网络正常访问没遇见报错，这步可省略</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90"><span class="toc-number">2.3.</span> <span class="toc-text">0x03 静态分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Android%E6%89%AB%E6%8F%8F%E5%86%85%E5%AE%B9"><span class="toc-number">2.3.1.</span> <span class="toc-text">Android扫描内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%A5%E5%91%8A%E6%9F%A5%E7%9C%8B"><span class="toc-number">2.3.2.</span> <span class="toc-text">报告查看</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#MobSF%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E2%80%94%E2%80%94%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E5%8E%9F%E7%90%86"><span class="toc-number">2.3.2.0.1.</span> <span class="toc-text">MobSF源码分析——静态分析原理</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-%E5%8A%A8%E6%80%81%E5%88%86%E6%9E%90"><span class="toc-number">2.4.</span> <span class="toc-text">0x04 动态分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">2.4.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E5%A4%87%E7%B3%BB%E7%BB%9F%E7%89%88%E6%9C%AC"><span class="toc-number">2.4.2.</span> <span class="toc-text">设备系统版本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTPS%E4%BB%A3%E7%90%86"><span class="toc-number">2.4.3.</span> <span class="toc-text">HTTPS代理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Genymotion"><span class="toc-number">2.4.4.</span> <span class="toc-text">安装Genymotion</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-%E5%AE%89%E8%A3%85%E7%95%8C%E9%9D%A2"><span class="toc-number">2.4.4.0.0.1.</span> <span class="toc-text">1.安装界面</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-%E9%80%89%E6%8B%A9%E4%B8%80%E4%B8%AAAndroid%E8%AE%BE%E5%A4%87%E5%90%8D%E7%A7%B0"><span class="toc-number">2.4.4.0.0.2.</span> <span class="toc-text">2.选择一个Android设备名称</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-%E4%B8%8D%E8%83%BD%E4%B8%BA%E8%99%9A%E6%8B%9F%E7%94%B5%E8%84%91%E6%89%93%E5%BC%80%E6%96%B0%E4%BB%BB%E5%8A%A1%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%8C%E7%BD%91%E7%BB%9C%E9%97%AE%E9%A2%98%EF%BC%8C%E9%80%9A%E8%BF%87%E5%90%AF%E5%8A%A8%E7%BD%91%E5%8D%A1%E8%A7%A3%E5%86%B3"><span class="toc-number">2.4.4.0.0.3.</span> <span class="toc-text">3.不能为虚拟电脑打开新任务的问题，网络问题，通过启动网卡解决</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-%E5%90%AF%E5%8A%A8%E5%90%8E%EF%BC%8C%E4%B8%80%E7%9B%B4%E5%8D%A1%E5%9C%A8starting-virtual-device%EF%BC%8C%E6%8A%8AOracle-VM-VirtualBox-%E5%88%A0%E9%99%A4%EF%BC%8C%E9%87%8D%E6%96%B0%E5%AE%89%E8%A3%85%E4%BA%86%E4%B8%80%E6%AC%A1%E5%8F%91%E7%8E%B0%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E4%BA%86%EF%BC%8CAndroid%E9%A1%BA%E5%88%A9%E8%BF%90%E8%A1%8C%E4%BA%86"><span class="toc-number">2.4.4.0.0.4.</span> <span class="toc-text">4.启动后，一直卡在starting virtual device，把Oracle VM VirtualBox 删除，重新安装了一次发现问题解决了，Android顺利运行了</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ARM%E8%BD%AC%E6%8D%A2"><span class="toc-number">2.4.5.</span> <span class="toc-text">ARM转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E5%88%86%E6%9E%90%E5%AE%9E%E9%AA%8C"><span class="toc-number">2.4.6.</span> <span class="toc-text">动态分析实验</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-%E5%BC%80%E5%90%AFmobsf%E5%92%8CGenymotion%E7%9A%84Android%E4%B9%8B%E5%90%8E%EF%BC%8Cmobsf%E4%BC%9A%E8%87%AA%E5%8A%A8%E8%AF%86%E5%88%AB%E9%93%BE%E6%8E%A5%EF%BC%8CIP%E5%9C%B0%E5%9D%80%E4%B8%8E%E5%AE%89%E5%8D%93%E7%9A%84%E5%9C%B0%E5%9D%80%E6%98%AF%E4%B8%80%E8%87%B4%E7%9A%84%E3%80%82"><span class="toc-number">2.4.6.0.0.1.</span> <span class="toc-text">1.开启mobsf和Genymotion的Android之后，mobsf会自动识别链接，IP地址与安卓的地址是一致的。</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-%E6%B5%8B%E8%AF%95%E5%8A%A8%E6%80%81%E5%88%86%E6%9E%90%E7%8E%AF%E5%A2%83%E6%98%AF%E5%90%A6%E6%AD%A3%E5%B8%B8%EF%BC%8C%E7%82%B9%E5%87%BBMobSFy-Android-Runtime-%E7%84%B6%E5%90%8E%E7%82%B9%E5%87%BB%E5%BC%B9%E7%AA%97%E7%95%8C%E9%9D%A2%E7%9A%84MobSFy"><span class="toc-number">2.4.6.0.0.2.</span> <span class="toc-text">2.测试动态分析环境是否正常，点击MobSFy Android Runtime,然后点击弹窗界面的MobSFy!</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-%E6%B5%8B%E8%AF%95%E6%AD%A3%E5%B8%B8%E4%B9%8B%E5%90%8E%E5%B0%B1%E5%8F%AF%E4%BB%A5%E5%8A%A8%E6%80%81%E5%88%86%E6%9E%90%E4%BA%86"><span class="toc-number">2.4.6.0.0.3.</span> <span class="toc-text">3.测试正常之后就可以动态分析了</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Show-Stop-Screen"><span class="toc-number">2.4.6.0.0.4.</span> <span class="toc-text">Show&#x2F;Stop Screen</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Install-Remove-MobSF-RootCA"><span class="toc-number">2.4.6.0.0.5.</span> <span class="toc-text">Install&#x2F;Remove MobSF RootCA</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Start-Exported-Activity-Tester"><span class="toc-number">2.4.6.0.0.6.</span> <span class="toc-text">Start Exported Activity Tester</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Start-Activity-Tester"><span class="toc-number">2.4.6.0.0.7.</span> <span class="toc-text">Start Activity Tester</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Take-a-Screenshot"><span class="toc-number">2.4.6.0.0.8.</span> <span class="toc-text">Take a Screenshot</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Generate-Report"><span class="toc-number">2.4.6.0.0.9.</span> <span class="toc-text">Generate Report</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/post/5a797a55.html" title="Suricata 解决缺失请求体与响应体的问题"><img src="/images/251030.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Suricata 解决缺失请求体与响应体的问题"/></a><div class="content"><a class="title" href="/post/5a797a55.html" title="Suricata 解决缺失请求体与响应体的问题">Suricata 解决缺失请求体与响应体的问题</a><time datetime="2025-10-30T03:30:41.000Z" title="发表于 2025-10-30 11:30:41">2025-10-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/144a22d3.html" title="洞态IAST部署"><img src="/images/250807.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="洞态IAST部署"/></a><div class="content"><a class="title" href="/post/144a22d3.html" title="洞态IAST部署">洞态IAST部署</a><time datetime="2025-08-07T06:39:27.000Z" title="发表于 2025-08-07 14:39:27">2025-08-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/3f9d8036.html" title="ShellCode免杀平台-EasyTools"><img src="/images/250621.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ShellCode免杀平台-EasyTools"/></a><div class="content"><a class="title" href="/post/3f9d8036.html" title="ShellCode免杀平台-EasyTools">ShellCode免杀平台-EasyTools</a><time datetime="2025-05-28T09:20:43.000Z" title="发表于 2025-05-28 17:20:43">2025-05-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/cec152a6.html" title="等保2.0"><img src="/images/250306.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="等保2.0"/></a><div class="content"><a class="title" href="/post/cec152a6.html" title="等保2.0">等保2.0</a><time datetime="2025-03-06T02:09:42.000Z" title="发表于 2025-03-06 10:09:42">2025-03-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/56f57219.html" title="WAF防护绕过"><img src="/images/250225_1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WAF防护绕过"/></a><div class="content"><a class="title" href="/post/56f57219.html" title="WAF防护绕过">WAF防护绕过</a><time datetime="2025-02-25T01:28:55.000Z" title="发表于 2025-02-25 09:28:55">2025-02-25</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">&copy;2025 By Egstar</div><div class="footer_custom_text">I wish you to become your own sun, no need to rely on who's light.<p><a target="_blank" href="https://hexo.io/"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为Hexo"></a>&nbsp;<a target="_blank" href="https://butterfly.js.org/"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用butterfly"></a>&nbsp;<a target="_blank" href="https://www.jsdelivr.com/"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="本站使用JsDelivr为静态资源提供CDN加速"></a> &nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Vervel-brightgreen?style=flat&logo=Vercel" title="本站采用双线部署，默认线路托管于Vercel"></a>&nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Coding-0cedbe?style=flat&logo=Codio" title="本站采用双线部署，联通线路托管于Coding"></a>&nbsp;<a target="_blank" href="https://github.com/"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由Gtihub托管"></a>&nbsp;<a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://twikoo.egstar.top/',
      region: 'ap-shanghai',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo.egstar.top/',
      region: 'ap-shanghai',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script src="/statics/mouse_hover.js"></script><script src="/statics/chocolate.js"></script><script defer src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script data-pjax defer src="https://npm.elemecdn.com/tzy-blog/lib/js/theme/chocolate.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></body></html>